{
  "$schema": "https://demotime.elio.dev/demo-time.schema.json",
  "title": "04 - Regular Expressions",
  "description": "Demonstrate mutation testing in JavaScript environment with Vitest and Stryker, focusing on regular expression patterns to show how complex logic can reveal test weaknesses through mutation testing.",
  "demos": [
    {
      "title": "Show calculator.js",
      "description": "Display the JavaScript calculator implementation to introduce the JavaScript environment for mutation testing.",
      "steps": [
        {
          "action": "closeTerminal"
        },
        {
          "action": "create",
          "path": "/js/src/calculator.js",
          "contentPath": "/snapshots/calculator.snapshot.js"
        },
        {
          "action": "open",
          "path": "/js/src/calculator.js"
        },
        {
          "action": "positionCursor",
          "path": "/js/src/calculator.js",
          "position": "1"
        }
      ]
    },
    {
      "title": "Show calculator.test",
      "description": "Display the JavaScript test file using Vitest to show the existing test coverage before adding regex functionality.",
      "steps": [
        {
          "action": "create",
          "path": "/js/src/calculator.test.js",
          "contentPath": "/snapshots/calculator.test.snapshot.js"
        },
        {
          "action": "open",
          "path": "/js/src/calculator.test.js"
        },
        {
          "action": "positionCursor",
          "path": "/js/src/calculator.test.js",
          "position": "1"
        }
      ]
    },
    {
      "title": "Run Stryker",
      "description": "Execute Stryker mutation testing in the JavaScript environment to establish a baseline mutation score.",
      "steps": [
        {
          "action": "executeTerminalCommand",
          "command": "Set-Location js -ErrorAction SilentlyContinue"
        },
        {
          "action": "executeTerminalCommand",
          "command": "Remove-Item -Recurse -Force .\\.stryker-tmp -ErrorAction SilentlyContinue"
        },
        {
          "action": "executeTerminalCommand",
          "command": "Clear"
        },
        {
          "action": "executeTerminalCommand",
          "command": "npx stryker run --cleanTempDir false"
        }
      ]
    },
    {
      "title": "Open mutation report",
      "description": "View the initial mutation report to see baseline scores before adding regex functionality.",
      "steps": [
        {
          "action": "executeTerminalCommand",
          "command": "reports/mutation/mutation.html"
        }
      ]
    },
    {
      "title": "Add \"testInput\" method",
      "description": "Add a method with a complex regular expression pattern to demonstrate how regex mutations can reveal test weaknesses.",
      "steps": [
        {
          "action": "insert",
          "path": "/js/src/calculator.js",
          "position": "26,0",
          "content": "\n  testInput(input) {\n    return /^[0-9]{3,}$/ig.test(input);\n  }\n}",
          "lineInsertionDelay": 500
        },
        {
          "action": "highlight",
          "path": "/js/src/calculator.js",
          "position": "27:29"
        }
      ]
    },
    {
      "title": "Add \"testInput\" test",
      "description": "Add a basic test for the regex method that only covers one scenario, demonstrating insufficient test coverage for complex patterns.",
      "steps": [
        {
          "action": "insert",
          "path": "/js/src/calculator.test.js",
          "position": "34,0",
          "content": "\n  it('testInput with valid input returns true', () => {\n    expect(calculator.testInput('123')).toBe(true);\n  });\n});",
          "lineInsertionDelay": 500
        },
        {
          "action": "highlight",
          "path": "/js/src/calculator.test.js",
          "position": "35:37"
        }
      ]
    },
    {
      "title": "Run Stryker",
      "description": "Re-run mutation testing with the new regex method to see how many mutants survive the insufficient test coverage.",
      "steps": [
        {
          "action": "executeTerminalCommand",
          "command": "Remove-Item -Recurse -Force .\\.stryker-tmp -ErrorAction SilentlyContinue"
        },
        {
          "action": "executeTerminalCommand",
          "command": "Clear"
        },
        {
          "action": "executeTerminalCommand",
          "command": "npx stryker run --cleanTempDir false"
        }
      ]
    },
    {
      "title": "Open mutation report",
      "description": "View the final mutation report to analyze how regex mutations revealed weaknesses in the single test case, demonstrating the value of mutation testing for complex patterns.",
      "steps": [
        {
          "action": "executeTerminalCommand",
          "command": "reports/mutation/mutation.html"
        }
      ]
    }
  ]
}